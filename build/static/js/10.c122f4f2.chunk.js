(this.webpackJsonptexas=this.webpackJsonptexas||[]).push([[10],{500:function(e,t,n){},616:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return I}));var a=n(31),r=n(0),o=n.n(r),c=n(42),i=n(438),u=n(612),l=n(34),s=n(442);n(500);function d(e){var t=e.list,n=Object(r.useContext)(l.a),a=[{title:"\u6392\u540d",key:"rank",render:function(e,t,n){return n+1}},{title:"\u9009\u624b",key:"username",render:function(e,t){var a,r=(a=t.player.get("objectId"),n.users.find((function(e){return e.get("objectId")===a}))),c=null===r||void 0===r?void 0:r.get("avatar"),u=null===r||void 0===r?void 0:r.get("name");return o.a.createElement("div",{className:"player-wrap"},o.a.createElement("div",{className:"avatar-wrap"},c?o.a.createElement(i.a,{size:24,src:c.get("url")}):o.a.createElement(i.a,{size:24,icon:o.a.createElement(s.a,null)})),u)}},{title:"\u53c2\u8d5b\u6b21\u6570",key:"count",dataIndex:"count"},{title:"\u5355\u6b21\u6700\u5927\u76c8\u5229",key:"max",dataIndex:"max",sorter:function(e,t){return e.max-t.max}},{title:"\u5355\u6b21\u6700\u5927\u4e8f\u635f",key:"min",dataIndex:"min",sorter:function(e,t){return e.min-t.min}},{title:"\u7d2f\u8ba1\u7b79\u7801\u76c8\u4e8f",key:"total",dataIndex:"total",sorter:function(e,t){return e.total-t.total}},{title:"\u7d2f\u8ba1\u76c8\u4e8f\u91d1\u989d",key:"totalBalance",dataIndex:"totalBalance",sorter:function(e,t){return e.totalBalance-t.totalBalance}},{title:"\u5f53\u524d\u8d54\u7387",key:"currentLeverage",dataIndex:"currentLeverage"},{title:"\u64cd\u4f5c",key:"opt",dataIndex:"opt"}];return o.a.createElement("div",{className:"rank-wrap"},o.a.createElement(u.a,{dataSource:t,columns:a,pagination:!1}))}var f=n(592),m=n(441),v=n(613),b=n(615),g=n(439),p=n(19),j=n.n(p),O=n(453),y=n.n(O);function k(e){var t=e.isModify,n=void 0!==t&&t,c=e.roundIndex,i=void 0===c?0:c,s=e.visible,d=e.onOk,p=e.onCancel,O=Object(r.useContext)(l.a),k=O.rounds,E=O.roundUserInfo,I=Object(r.useState)([{roundNO:k.length+1}]),x=Object(a.a)(I,2),h=x[0],C=x[1],w=Object(r.useState)(""),N=Object(a.a)(w,2),Y=N[0],S=N[1],M=Object(r.useState)(.1),D=Object(a.a)(M,2),T=D[0],U=D[1],B=Object(r.useState)({}),R=Object(a.a)(B,2),A=R[0],z=R[1];function J(e){S(e?e.format("YYYY/MM/DD"):"")}function L(e){U(e||.1)}return Object(r.useEffect)((function(){if(n){var e=E[i],t=k[i],a={};e&&e.forEach((function(e){a[e.get("player").get("objectId")]=e.get("amount")})),C([{roundNO:i+1}]),U(t.get("leverage")),S(t.get("dateTime")),z(a)}}),[n,E,i,k]),o.a.createElement(g.a,{visible:s,onCancel:function(){p()},onOk:function(){if(n){var e=O.rounds[i],t=O.roundUserInfo[i],a=j.a.Object.createWithoutData("Round",e.get("objectId"));a.set("dateTime",Y),a.set("leverage",T);var r=[];return Object.keys(A).forEach((function(e){var n,o=t.find((function(t){return t.get("player").get("objectId")===e}));if(o)n=o;else{var c=O.users.find((function(t){return t.get("objectId")===e}));(n=new(j.a.Object.extend("RoundUserInfo"))).set("round",a),n.set("player",c)}n.set("amount",A[e]),r.push(n)})),Promise.all([a.save(),j.a.Object.saveAll(r)]).then((function(){d&&d()})).catch((function(e){m.a.error(e.message)}))}var o=new(j.a.Object.extend("Round"));o.set("dateTime",Y),o.set("leverage",T);var c=j.a.Object.extend("RoundUserInfo"),u=[];return Object.keys(A).forEach((function(e){var t=new c,n=O.users.find((function(t){return t.get("objectId")===e}));t.set("round",o),t.set("player",n),t.set("amount",A[e]),u.push(t)})),j.a.Object.saveAll(u).then((function(){d&&d()})).catch((function(e){m.a.error(e.message)}))},width:1200},o.a.createElement("div",{className:"add-round-wrap"},o.a.createElement(u.a,{dataSource:h,columns:[{title:"\u573a\u6b21",key:"roundNO",dataIndex:"roundNO",ellipsis:!0},{title:"\u65e5\u671f",key:"dateTime",ellipsis:!0,render:function(){return console.log("dateTime::",Y),o.a.createElement("div",{style:{width:"150px"}},o.a.createElement(v.a,{onChange:J,format:"YYYY/MM/DD",value:Y&&y()(Y,"YYYY/MM/DD")||void 0}))}},{title:"\u6760\u6746\u6bd4\u4f8b",key:"leverage",ellipsis:!0,render:function(){return o.a.createElement(b.a,{onChange:L,value:T})}}].concat(O.users.map((function(e){return{title:e.get("name"),key:e.get("objectId"),ellipsis:!0,render:function(){return o.a.createElement(b.a,{onChange:function(t){return function(e,t){e=e?+e:0;var n=Object(f.a)({},A);n[t.get("objectId")]=e,z(n)}(t,e)},value:A[e.get("objectId")]})}}}))),pagination:!1,scroll:{x:!0}})))}function E(e){var t=e.visible,n=e.onModify,a=e.onOk,c=e.onCancel,i=Object(r.useContext)(l.a);var s=i.rounds;return o.a.createElement(g.a,{visible:t,onCancel:c,onOk:a,width:1200},o.a.createElement("div",{className:"details-round-wrap"},o.a.createElement(u.a,{dataSource:s,columns:function(){var e=[{title:"\u573a\u6b21",key:"roundNO",ellipsis:!0,render:function(e,t,n){return n+1}},{title:"\u65e5\u671f",key:"dateTime",ellipsis:!0,render:function(e,t){return t.get("dateTime")}},{title:"\u6760\u6746\u6bd4\u4f8b",key:"leverage",ellipsis:!0,render:function(e,t){return t.get("leverage")}}],t=i.users;return e=e.concat(t.map((function(e){return{title:e.get("name"),key:e.get("objectId"),ellipsis:!0,render:function(t,n,a){return function(e,t){var n=i.roundUserInfo[t];if(n){var a=n.find((function(t){return t.get("player").get("objectId")===e}));return a&&a.get("amount")||""}return""}(e.get("objectId"),a)}}}))),j.a.User.current()&&(e=e.concat({title:"\u64cd\u4f5c",key:"opt",render:function(e,t,a){return o.a.createElement("div",{className:"details-opt"},o.a.createElement("span",{onClick:function(){return function(e){n(e)}(a)}},"\u4fee\u6539"))}})),e}(),pagination:!1,scroll:{x:!0}})))}function I(e){var t=e.onAddDone,n=e.list,i=Object(r.useState)(!1),u=Object(a.a)(i,2),l=u[0],s=u[1],f=Object(r.useState)(!1),m=Object(a.a)(f,2),v=m[0],b=m[1],g=Object(r.useState)(!1),p=Object(a.a)(g,2),O=p[0],y=p[1],I=Object(r.useState)(-1),x=Object(a.a)(I,2),h=x[0],C=x[1],w=j.a.User.current();return o.a.createElement("div",{className:"page home"},o.a.createElement(d,{list:n}),o.a.createElement("div",{className:"btn-wrap"},o.a.createElement(c.a,{type:"primary",onClick:function(){b(!1),y(!0)}},"\u660e\u7ec6"),w?o.a.createElement(c.a,{type:"primary",onClick:function(){s(!0)}},"\u589e\u52a0\u8bb0\u5f55"):null),o.a.createElement(k,{visible:l,onOk:function(){s(!1),t()},onCancel:function(){s(!1)},isModify:v,roundIndex:h}),o.a.createElement(E,{visible:O,onOk:function(){y(!1)},onCancel:function(){y(!1)},onModify:function(e){C(e),b(!0),y(!1),s(!0)}}))}}}]);
//# sourceMappingURL=10.c122f4f2.chunk.js.map