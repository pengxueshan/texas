{"version":3,"sources":["api/round.ts","store/action.ts","api/player.ts","utils/win-times.ts","utils/request.ts","store/context.ts","api/user.ts","components/Session/index.tsx","components/TopBar/index.tsx","components/App/index.tsx","serviceWorker.js","store/reducer.ts","store/index.ts","index.tsx"],"names":["addRound","a","params","request","url","method","data","getRounds","getRankList","getRoundDetails","updateRound","setPlayers","players","type","payload","setRounds","rounds","setRoundDetails","roundDetails","setWinTimes","winTimes","types","SET_USER_INFO","SET_PLAYERS","SET_ROUNDS","SET_SHOW_SESSION","SET_IS_AUTHENTICATED","SET_ROUND_DETAILS","SET_WIN_TIMES","getPlayers","addPlayer","formatWinTimes","times","forEach","round","player","amount","undefined","playerId","req","axios","baseURL","ret","status","React","createContext","showSession","setShowSession","isAuthenticated","setIsAuthenticated","Session","visible","useState","confirmLoading","setConfirmLoading","mobile","setMobile","password","setPassword","context","useContext","AppContext","title","onOk","login","phoneNumber","MD5","toString","toLowerCase","then","user","catch","error","message","onCancel","className","placeholder","value","onChange","e","target","TopBar","to","onClick","Home","lazy","Encrypt","App","state","list","props","res","setState","handleAddDone","this","fallback","style","display","justifyContent","alignItems","path","onAddDone","Component","mapDispatchToProps","connect","Boolean","window","location","hostname","match","combineReducers","userInfo","action","createStore","reducer","ReactDOM","render","locale","zhCN","store","document","getElementById","navigator","serviceWorker","ready","registration","unregister","console"],"mappings":"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","file":"static/js/main.592d4014.chunk.js","sourcesContent":["import request from '../utils/request';\n\nexport async function addRound(params: object = {}) {\n  return await request({\n    url: '/addRound',\n    method: 'post',\n    data: {\n      ...params\n    }\n  });\n}\n\nexport async function getRounds(params: object = {}) {\n  return await request({\n    url: '/rounds',\n    method: 'post',\n    data: {\n      ...params\n    }\n  });\n}\n\nexport async function getRankList(params: object = {}) {\n  return await request({\n    url: '/ranklist',\n    method: 'post',\n    data: {\n      ...params\n    }\n  });\n}\n\nexport async function getRoundDetails(params: object = {}) {\n  return await request({\n    url: '/roundDetails',\n    method: 'post',\n    data: {\n      ...params\n    }\n  });\n}\n\nexport async function updateRound(params: object = {}) {\n  return await request({\n    url: '/updateRound',\n    method: 'post',\n    data: {\n      ...params\n    }\n  });\n}","const SET_USER_INFO = 'SET_USER_INFO';\nconst SET_PLAYERS = 'SET_PLAYERS';\nconst SET_ROUNDS = 'SET_ROUNDS';\nconst SET_SHOW_SESSION = 'SET_SHOW_SESSION';\nconst SET_IS_AUTHENTICATED = 'SET_IS_AUTHENTICATED';\nconst SET_ROUND_DETAILS = 'SET_ROUND_DETAILS';\nconst SET_WIN_TIMES = 'SET_WIN_TIMES';\n\nexport interface UserInfo {\n  id: number\n}\n\nexport function setUserInfo(userInfo: UserInfo) {\n  return {\n    type: SET_USER_INFO,\n    payload: {\n      userInfo,\n    },\n  };\n}\n\nexport function setPlayers(players: []) {\n  return {\n    type: SET_PLAYERS,\n    payload: {\n      players,\n    },\n  };\n}\n\nexport function setRounds(rounds: []) {\n  return {\n    type: SET_ROUNDS,\n    payload: {\n      rounds,\n    },\n  };\n}\n\nexport function setRoundDetails(roundDetails: object) {\n  return {\n    type: SET_ROUND_DETAILS,\n    payload: {\n      roundDetails,\n    },\n  };\n}\n\nexport function setWinTimes(winTimes: object) {\n  return {\n    type: SET_WIN_TIMES,\n    payload: {\n      winTimes,\n    },\n  };\n}\n\nexport function setShowSession(showSession: boolean) {\n  return {\n    type: SET_SHOW_SESSION,\n    payload: {\n      showSession,\n    },\n  };\n}\n\nexport function setIsAuthenticated(isAuthenticated: boolean) {\n  return {\n    type: SET_IS_AUTHENTICATED,\n    payload: {\n      isAuthenticated,\n    },\n  };\n}\n\nexport const types = {\n  SET_USER_INFO,\n  SET_PLAYERS,\n  SET_ROUNDS,\n  SET_SHOW_SESSION,\n  SET_IS_AUTHENTICATED,\n  SET_ROUND_DETAILS,\n  SET_WIN_TIMES\n};\n","import request from '../utils/request';\n\nexport async function getPlayers(params: object = {}) {\n  return await request({\n    url: '/players',\n    method: 'post',\n    data: {\n      ...params\n    }\n  });\n}\n\nexport async function addPlayer(params: object = {}) {\n  return await request({\n    url: '/addPlayer',\n    method: 'post',\n    data: {\n      ...params\n    }\n  });\n}","import { RoundDetails } from './types';\n\ninterface Times {\n  [index: number]: number;\n}\n\nexport default function formatWinTimes(rounds: [RoundDetails]) {\n  const times: Times = {};\n  rounds.forEach((round) => {\n    round.players.forEach((player) => {\n      if (player.amount > 0) {\n        if (times[player.playerId] === undefined) {\n          times[player.playerId] = 0;\n        }\n        times[player.playerId] += 1;\n      }\n    });\n  });\n  return times;\n}","import axios from 'axios';\n\nlet baseUrl: string = '/api';\n\nif (process.env.NODE_ENV === 'development') {\n  baseUrl = 'http://127.0.0.1:7001';\n}\n\nexport default async function request(req: object) {\n  let ret = await axios({\n    baseURL: baseUrl,\n    ...req,\n  });\n  const { status, data } = ret;\n  if (status === 200) {\n    return data.data;\n  }\n}\n","import React from 'react';\nimport { Player, Round, RoundDetails } from '../utils/types';\n\nexport interface ContextType {\n  players: Player[];\n  rounds: Round[];\n  roundDetails: RoundDetails[];\n  showSession: boolean;\n  setPlayers: Function;\n  setRounds: Function;\n  setShowSession: Function;\n  isAuthenticated: boolean;\n  setIsAuthenticated: Function;\n  getPlayers: Function;\n  getRounds: Function;\n  setRoundDetails: Function;\n}\n\nexport const defaultContext: ContextType = {\n  players: [],\n  rounds: [],\n  roundDetails: [],\n  showSession: false,\n  setPlayers: () => {},\n  setRounds: () => {},\n  setShowSession: () => {},\n  isAuthenticated: false,\n  setIsAuthenticated: () => {},\n  getPlayers: () => {},\n  getRounds: () => {},\n  setRoundDetails: () => {},\n};\n\nexport default React.createContext(defaultContext);\n","import request from '../utils/request';\n\nexport async function login(params: object = {}) {\n  return await request({\n    url: '/login',\n    method: 'post',\n    data: {\n      ...params\n    }\n  });\n}","import React, { useState, ChangeEvent, useContext, useRef } from 'react';\nimport { Modal, Input, Button, message } from 'antd';\nimport './session.scss';\nimport AppContext from '../../store/context';\nimport { MD5 } from 'crypto-js';\nimport { login } from '../../api/user';\n\ninterface Props {\n  visible: boolean;\n}\n\nexport default function Session({ visible }: Props) {\n  const [confirmLoading, setConfirmLoading] = useState(false);\n  const [mobile, setMobile] = useState('');\n  const [password, setPassword] = useState('');\n  // const [verifyCode, setVerifyCode] = useState('');\n  // const [verifyCount, setVerifyCount] = useState(0);\n  // const countRef = useRef(verifyCount);\n  // countRef.current = verifyCount;\n  const [inviteCode, setInviteCodeChange] = useState('');\n  const context = useContext(AppContext);\n\n  function handleOk() {\n    if (!mobile) {\n      return message.error('请输入手机号');\n    }\n    if (!password) {\n      return message.error('请输入密码');\n    }\n    // if (!verifyCode) {\n    //   return message.error('请输入验证码');\n    // }\n    // if (!inviteCode) {\n    //   return message.error('请输入邀请码');\n    // }\n    // if (MD5(inviteCode).toString() !== '41b9df4a217bb3c10b1c339358111b0d') {\n    //   return message.error('邀请码错误');\n    // }\n    setConfirmLoading(true);\n    login({\n      phoneNumber: `+86${mobile}`,\n      password: MD5(password).toString().toLowerCase(),\n    })\n      .then((user) => {\n        setConfirmLoading(false);\n        context.setShowSession(false);\n      })\n      .catch((error) => {\n        setConfirmLoading(false);\n        error && message.error(error.message);\n      });\n  }\n\n  function handleCancel() {\n    context.setShowSession(false);\n  }\n\n  function handleMobileChange(e: ChangeEvent<HTMLInputElement>) {\n    setMobile(e.target.value);\n  }\n\n  function handlePasswordChange(e: ChangeEvent<HTMLInputElement>) {\n    setPassword(e.target.value);\n  }\n\n  // function handleVerifyCodeChange(e: ChangeEvent<HTMLInputElement>) {\n  //   setVerifyCode(e.target.value);\n  // }\n\n  // function getButtonText() {\n  //   if (verifyCount <= 0) {\n  //     return '获取验证码';\n  //   } else {\n  //     return `${verifyCount}s`;\n  //   }\n  // }\n\n  // function handleVerifyClick() {\n  //   if (verifyCount > 0 || !mobile) return;\n  //   AV.Cloud.requestSmsCode(`+86${mobile}`).then(() => {\n  //     setVerifyCount(60);\n  //     startCount();\n  //   });\n  // }\n\n  // function startCount() {\n  //   setTimeout(countDown, 1000);\n  // }\n\n  // function countDown() {\n  //   if (countRef.current <= 0) return;\n  //   setVerifyCount(countRef.current - 1);\n  //   setTimeout(countDown, 1000);\n  // }\n\n  function handleInviteChange(e: ChangeEvent<HTMLInputElement>) {\n    setInviteCodeChange(e.target.value);\n  }\n\n  return (\n    <Modal\n      title=\"登录\"\n      visible={visible}\n      onOk={handleOk}\n      onCancel={handleCancel}\n      confirmLoading={confirmLoading}\n    >\n      <div className=\"session\">\n        <div className=\"form-row\">\n          <Input\n            placeholder=\"手机号码\"\n            value={mobile}\n            onChange={handleMobileChange}\n          />\n        </div>\n        <div className=\"form-row\">\n          <Input\n            placeholder=\"密码\"\n            value={password}\n            onChange={handlePasswordChange}\n            type=\"password\"\n          />\n        </div>\n        {/* <div className=\"form-row\">\n          <Input\n            placeholder=\"验证码\"\n            value={verifyCode}\n            onChange={handleVerifyCodeChange}\n          />\n          <Button disabled={verifyCount > 0} onClick={handleVerifyClick}>\n            {getButtonText()}\n          </Button>\n        </div> */}\n        {/* <div className=\"form-row\">\n          <Input\n            placeholder=\"邀请码\"\n            value={inviteCode}\n            onChange={handleInviteChange}\n          />\n        </div> */}\n      </div>\n    </Modal>\n  );\n}\n","import React, { useContext } from 'react';\nimport './top-bar.scss';\nimport Session from '../Session';\nimport AppContext from '../../store/context';\nimport { Modal, Avatar } from 'antd';\nimport { Link } from 'react-router-dom';\nimport { UserOutlined } from '@ant-design/icons';\n\nexport default function TopBar() {\n  const context = useContext(AppContext);\n\n  function handleSigninClick() {\n    context.setShowSession(true);\n  }\n\n  function handleSignoutClick() {\n    Modal.confirm({\n      title: '确定退出登录吗？',\n      onOk() {\n        // return AV.User.logOut().then(() => {\n        //   window.location.href = '/';\n        // });\n      },\n    });\n  }\n\n  let avatar = '';\n  let currentUser = '';\n\n  const renderAvatar = () => {\n    return (\n      <Link key=\"setting\" to=\"/profile\">\n        {avatar ? (\n          <Avatar size={32} src={avatar} />\n        ) : (\n          <Avatar size={32} icon={<UserOutlined />} />\n        )}\n      </Link>\n    );\n  };\n\n  return (\n    <div className=\"top-bar\">\n      <nav>\n        <ul>\n          <li>\n            <Link to=\"/\">排行榜</Link>\n          </li>\n          {/* <li>\n            <Link to=\"/photo\">精彩瞬间</Link>\n          </li>\n          <li>\n            <Link to=\"/message\">聊天室</Link>\n          </li> */}\n        </ul>\n      </nav>\n      <div className=\"user-section\">\n        {!currentUser ? (\n          <span className=\"link-style\" onClick={handleSigninClick}>\n            登录\n          </span>\n        ) : (\n          [\n            renderAvatar(),\n            <span\n              key=\"logout\"\n              className=\"link-style\"\n              onClick={handleSignoutClick}\n            >\n              退出登录\n            </span>,\n          ]\n        )}\n        <Session visible={context.showSession} />\n      </div>\n    </div>\n  );\n}\n","import React, { Component, lazy, Suspense } from 'react';\nimport TopBar from '../TopBar';\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom';\nimport PrivateRoute from '../PrivateRoute';\nimport { Spin } from 'antd';\nimport { connect } from 'react-redux';\n\nimport { Player, Round, RankListData, RoundDetails } from '../../utils/types';\nimport { getPlayers } from '../../api/player';\nimport { getRankList, getRounds, getRoundDetails } from '../../api/round';\nimport {\n  setPlayers,\n  setRounds,\n  setRoundDetails,\n  setWinTimes,\n} from '../../store/action';\nimport formatWinTimes from '../../utils/win-times';\nimport './app.scss';\nimport 'antd/dist/antd.css';\n\n// const Message = lazy(() => import('../../pages/Message'));\n// const Profile = lazy(() => import('../../pages/Profile'));\n// const Auth = lazy(() => import('../../pages/Auth'));\nconst Home = lazy(() => import('../../pages/Home'));\n// const Photo = lazy(() => import('../../pages/Photo'));\nconst Encrypt = lazy(() => import('../../pages/Encrypt'));\n\ninterface State {\n  list: [];\n}\n\ninterface Props {\n  setPlayers: Function;\n  setRounds: Function;\n  setRoundDetails: Function;\n  setWinTimes: Function;\n}\n\nclass App extends Component<Props> {\n  state: State = {\n    list: [],\n  };\n\n  getPlayers = async () => {\n    const players = await getPlayers();\n    this.props.setPlayers(players);\n  };\n\n  getRounds = async () => {\n    const rounds = await getRounds();\n    this.props.setRounds(rounds);\n  };\n\n  getRoundDetails = async () => {\n    const rounds: [RoundDetails] = await getRoundDetails();\n    this.props.setRoundDetails(rounds);\n    const times = formatWinTimes(rounds);\n    this.props.setWinTimes(times);\n  };\n\n  componentDidMount() {\n    this.getPlayers();\n    this.getRounds();\n    this.getRankList();\n  }\n\n  getRankList = () => {\n    getRankList().then((res) => {\n      this.setState({\n        list: res,\n      });\n    });\n  };\n\n  handleAddDone = () => {\n    this.getRankList();\n    this.getRounds();\n    this.getRoundDetails();\n  };\n\n  render() {\n    let { list } = this.state;\n    const isDev = process.env.NODE_ENV === 'development';\n    return (\n      <div className=\"app\">\n        <Router>\n          {/* {isAuthenticated || isDev ? <TopBar /> : null} */}\n          <TopBar />\n          <Suspense\n            fallback={\n              <div\n                style={{\n                  display: 'flex',\n                  justifyContent: 'center',\n                  alignItems: 'center',\n                }}\n              >\n                <Spin />\n              </div>\n            }\n          >\n            <Switch>\n              {/* <PrivateRoute path=\"/photo\">\n                  <Photo />\n                </PrivateRoute>\n                <PrivateRoute path=\"/message\">\n                  <Message />\n                </PrivateRoute>\n                <PrivateRoute path=\"/profile\">\n                  <Profile />\n                </PrivateRoute> */}\n              <Route path=\"/encrypt\">\n                <Encrypt />\n              </Route>\n              {/* <Route path=\"/auth\">\n                  <Auth />\n                </Route> */}\n              {/* <PrivateRoute path=\"/\">\n                  <Home list={list} onAddDone={this.handleAddDone} />\n                </PrivateRoute> */}\n              <Route path=\"/\">\n                <Home list={list} onAddDone={this.handleAddDone} />\n              </Route>\n            </Switch>\n          </Suspense>\n        </Router>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = () => {\n  return {};\n};\n\nconst mapDispatchToProps = {\n  setPlayers,\n  setRounds,\n  setRoundDetails,\n  setWinTimes,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import { types } from './action';\nimport { combineReducers } from 'redux';\nimport { Player, RoundDetails, WinTimes} from '../utils/types';\n\nexport interface Action {\n  type: string;\n  payload: any;\n}\n\nexport interface StoreType {\n  userInfo: object | null;\n  players: [Player];\n  rounds: [];\n  roundDetails: [RoundDetails];\n  showSession: boolean;\n  isAuthenticated: boolean;\n  winTimes: WinTimes;\n}\n\nfunction userInfo(state = null, action: Action) {\n  switch (action.type) {\n    case types.SET_USER_INFO:\n      state = action.payload.userInfo;\n      return state;\n    default:\n      return state;\n  }\n}\n\nfunction players(state = [], action: Action) {\n  switch (action.type) {\n    case types.SET_PLAYERS:\n      state = action.payload.players;\n      return state;\n    default:\n      return state;\n  }\n}\n\nfunction rounds(state = [], action: Action) {\n  switch (action.type) {\n    case types.SET_ROUNDS:\n      state = action.payload.rounds;\n      return state;\n    default:\n      return state;\n  }\n}\n\nfunction roundDetails(state = [], action: Action) {\n  switch (action.type) {\n    case types.SET_ROUND_DETAILS:\n      state = action.payload.roundDetails;\n      return state;\n    default:\n      return state;\n  }\n}\n\nfunction winTimes(state = {}, action: Action) {\n  switch (action.type) {\n    case types.SET_WIN_TIMES:\n      state = action.payload.winTimes;\n      return state;\n    default:\n      return state;\n  }\n}\n\nfunction showSession(state = false, action: Action) {\n  switch (action.type) {\n    case types.SET_SHOW_SESSION:\n      state = action.payload.showSession;\n      return state;\n    default:\n      return state;\n  }\n}\n\nfunction isAuthenticated(state = false, action: Action) {\n  switch (action.type) {\n    case types.SET_IS_AUTHENTICATED:\n      state = action.payload.isAuthenticated;\n      return state;\n    default:\n      return state;\n  }\n}\n\nexport default combineReducers({ userInfo, players, rounds, roundDetails, showSession, isAuthenticated, winTimes });\n","import { createStore } from 'redux';\nimport reducer from './reducer';\n\nexport default createStore(reducer);\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.scss';\nimport App from './components/App';\nimport * as serviceWorker from './serviceWorker';\nimport zhCN from 'antd/es/locale/zh_CN';\nimport { ConfigProvider } from 'antd';\nimport { Provider } from 'react-redux';\nimport store from './store';\n\nReactDOM.render(\n  <ConfigProvider locale={zhCN}>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </ConfigProvider>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}