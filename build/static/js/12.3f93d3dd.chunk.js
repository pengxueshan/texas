(this.webpackJsonptexas=this.webpackJsonptexas||[]).push([[12],{478:function(e,a,t){},615:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return k}));var n=t(39),r=t(66),l=t(156),c=t(95),i=t(0),s=t.n(i),u=t(428),o=t(475),v=t(40),d=t(425),m=t(612),h=t(19),f=t.n(h),g={name:"edit",theme:"outlined",icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]}},p=t(219),E=function(e,a){return i.createElement(p.a,Object.assign({},e,{ref:a,icon:g}))};E.displayName="EditOutlined";var y=i.forwardRef(E),b=t(429),P=t(54),k=(t(478),function(e){Object(c.a)(t,e);var a=Object(l.a)(t);function t(){var e;Object(n.a)(this,t);for(var r=arguments.length,l=new Array(r),c=0;c<r;c++)l[c]=arguments[c];return(e=a.call.apply(a,[this].concat(l))).state={isEdit:!1,relativePlayer:"",isSaving:!1},e.handleEditClick=function(){e.setState({isEdit:!0})},e.handleRelativePlayer=function(){if(!e.state.isSaving){var a=f.a.Object.createWithoutData("Player",e.state.relativePlayer),t=f.a.User.current();a.set("user",t),t.set("player",a),e.setState({isSaving:!0}),Promise.all([a.save(),t.save()]).then((function(){e.setState({isEdit:!1,isSaving:!1})}),(function(a){u.a.error(a.message),e.setState({isSaving:!1})}))}},e.handlePlayerSelectChange=function(a){e.setState({relativePlayer:a})},e.handleUploadAvatar=function(e){var a=new f.a.File(e.name,e);a.metaData("type",1);var t,n=f.a.User.current();n.set("avatar",a),n.get("player")&&(t=n.get("player").get("objectId"),(t=f.a.Object.createWithoutData("Player",t)).set("avatar",a));var r=[n.save()];return t&&r.push(t.save()),Promise.all(r).then((function(){u.a.success("\u4e0a\u4f20\u6210\u529f")})).catch((function(e){u.a.error(e.message)})),!1},e}return Object(r.a)(t,[{key:"getRelativePlayer",value:function(){var e=f.a.User.current().get("player");if(!e)return"--";var a=this.context.users.find((function(a){return a.get("objectId")===e.get("objectId")}));return a&&a.get("name")||"--"}},{key:"renderPlayer",value:function(){var e=this,a=this.context.users;if(this.state.isEdit){var t=f.a.User.current().get("player");return t=t&&t.get("objectId")||"",s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{style:{width:120},placeholder:"\u8bf7\u9009\u62e9\u9009\u624b",onChange:this.handlePlayerSelectChange,defaultValue:t},a.map((function(e){var a=e.get("objectId");return s.a.createElement(o.a.Option,{value:a,key:a},e.get("name"))}))),s.a.createElement(v.a,{type:"link",onClick:this.handleRelativePlayer},"\u4fdd\u5b58"),s.a.createElement(v.a,{type:"link",onClick:function(){e.setState({isEdit:!1})}},"\u53d6\u6d88"),s.a.createElement("span",null,"\u672a\u627e\u5230\u9009\u624b\uff1f\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6dfb\u52a0"))}return s.a.createElement(s.a.Fragment,null,this.getRelativePlayer(),s.a.createElement("div",{className:"edit-wrap",onClick:this.handleEditClick},s.a.createElement(y,null)))}},{key:"renderAvatar",value:function(){var e=f.a.User.current().get("avatar");return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"avatar-wrap"},e?s.a.createElement(d.a,{size:64,src:e.get("url")}):s.a.createElement(d.a,{size:64,icon:s.a.createElement(b.a,null)})),s.a.createElement(m.a,{beforeUpload:this.handleUploadAvatar,showUploadList:!1},s.a.createElement(v.a,null,"\u4e0a\u4f20")))}},{key:"render",value:function(){return s.a.createElement("div",{className:"page profile"},s.a.createElement("div",{className:"row"},s.a.createElement("span",{className:"label"},"\u5173\u8054\u9009\u624b"),s.a.createElement("div",{className:"content"},this.renderPlayer())),s.a.createElement("div",{className:"row"},s.a.createElement("span",{className:"label"},"\u5934\u50cf"),s.a.createElement("div",{className:"content"},this.renderAvatar())))}}]),t}(s.a.Component));k.contextType=P.a}}]);
//# sourceMappingURL=12.3f93d3dd.chunk.js.map